<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Will You Be My Valentine?</title>

    <!-- Google Fonts - Including Minecraft-style fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&family=Silkscreen:wght@400;700&family=Great+Vibes&family=Quicksand:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        /* ============================================
           CSS VARIABLES
        ============================================ */
        :root {
            --color-primary: #ff6b9d;
            --color-secondary: #c44569;
            --color-accent: #ff8fab;
            --color-gold: #ffd700;
            --color-cream: #fdf8f5;
            --color-text: #4a3f3f;
            --color-text-light: #7a6b6b;
            --font-minecraft: 'Press Start 2P', 'VT323', monospace;
            --font-pixel: 'Silkscreen', cursive;
            --font-script: 'Great Vibes', cursive;
            --font-body: 'Quicksand', sans-serif;
            --transition-smooth: cubic-bezier(0.4, 0, 0.2, 1);
            --transition-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* ============================================
           BASE STYLES
        ============================================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><text y="24" font-size="24">üíï</text></svg>') 16 16, auto;
        }

        body {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: var(--font-body);
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);
            overflow: hidden;
            position: relative;
        }

        /* ============================================
           SETUP SCREEN
        ============================================ */
        .setup-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 200;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        .setup-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .setup-box {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px 50px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            max-width: 450px;
            width: 90%;
            border: 4px solid var(--color-primary);
            animation: pixelBounce 0.6s var(--transition-bounce);
        }

        @keyframes pixelBounce {
            0% { transform: scale(0) rotate(-10deg); }
            60% { transform: scale(1.1) rotate(2deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        .setup-title {
            font-family: var(--font-minecraft);
            font-size: 1.1rem;
            color: var(--color-secondary);
            margin-bottom: 10px;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.1);
            line-height: 1.6;
        }

        .setup-subtitle {
            font-family: var(--font-pixel);
            font-size: 1.2rem;
            color: var(--color-text-light);
            margin-bottom: 25px;
        }

        .setup-heart {
            font-size: 50px;
            animation: heartFloat 2s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes heartFloat {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.1); }
        }

        .setup-input-group {
            margin-bottom: 20px;
        }

        .setup-label {
            font-family: var(--font-minecraft);
            font-size: 0.6rem;
            color: var(--color-text);
            display: block;
            margin-bottom: 10px;
            text-align: left;
        }

        .setup-input {
            width: 100%;
            padding: 14px 18px;
            border: 3px solid #ddd;
            border-radius: 10px;
            font-family: var(--font-body);
            font-size: 0.95rem;
            transition: all 0.3s ease;
            outline: none;
        }

        .setup-input:focus {
            border-color: var(--color-primary);
            box-shadow: 0 0 0 4px rgba(255, 107, 157, 0.2);
        }

        .setup-input::placeholder {
            color: #aaa;
            font-style: italic;
        }

        .setup-hint {
            font-size: 0.75rem;
            color: #999;
            margin-top: 8px;
            text-align: left;
        }

        .setup-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .setup-btn {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: 10px;
            font-family: var(--font-minecraft);
            font-size: 0.65rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .setup-btn-primary {
            background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
            color: white;
            box-shadow: 0 4px 15px rgba(196, 69, 105, 0.4);
        }

        .setup-btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(196, 69, 105, 0.5);
        }

        .setup-btn-secondary {
            background: #f0f0f0;
            color: var(--color-text);
        }

        .setup-btn-secondary:hover {
            background: #e0e0e0;
        }

        /* ============================================
           STARRY BACKGROUND
        ============================================ */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.5); }
        }

        .shooting-star {
            position: absolute;
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, white, transparent);
            animation: shoot 4s ease-in-out infinite;
            opacity: 0;
        }

        @keyframes shoot {
            0% { transform: translateX(0) translateY(0); opacity: 0; }
            5% { opacity: 1; }
            100% { transform: translateX(-600px) translateY(400px); opacity: 0; }
        }

        /* ============================================
           BACKGROUND IMAGE
        ============================================ */
        .background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
            background-size: cover;
            background-position: center;
            opacity: 0.2;
            transition: opacity 0.5s ease;
        }

        /* ============================================
           FLOATING ELEMENTS
        ============================================ */
        .floating-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
            overflow: hidden;
        }

        .floating-heart {
            position: absolute;
            bottom: -50px;
            opacity: 0;
            animation: floatUp 10s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(255, 100, 150, 0.5));
        }

        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg) scale(0.5); opacity: 0; }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% { transform: translateY(-100vh) rotate(360deg) scale(1); opacity: 0; }
        }

        .pixel-heart {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #ff6b9d;
            clip-path: polygon(50% 0%, 100% 35%, 100% 70%, 50% 100%, 0% 70%, 0% 35%);
            animation: pixelFloat 8s ease-in-out infinite;
            opacity: 0;
        }

        @keyframes pixelFloat {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.7; }
            90% { opacity: 0.7; }
            100% { transform: translateY(-50px) rotate(180deg); opacity: 0; }
        }

        /* ============================================
           ENVELOPE
        ============================================ */
        .envelope-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            background: transparent;
            transition: opacity 0.8s ease, visibility 0.8s ease;
            opacity: 0;
            visibility: hidden;
        }

        .envelope-container.visible {
            opacity: 1;
            visibility: visible;
        }

        .envelope-container.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .envelope {
            position: relative;
            width: 280px;
            height: 180px;
            cursor: pointer;
            animation: envelopeFloat 3s ease-in-out infinite;
        }

        @keyframes envelopeFloat {
            0%, 100% { transform: translateY(0) rotate(-2deg); }
            50% { transform: translateY(-15px) rotate(2deg); }
        }

        .envelope-body {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(145deg, #fff5f5, #ffe4e8);
            border-radius: 10px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .envelope-flap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(145deg, #fff0f3, #ffd6dc);
            clip-path: polygon(0 0, 50% 60%, 100% 0);
            transform-origin: top center;
            transition: transform 0.6s ease;
            z-index: 2;
        }

        .envelope:hover .envelope-flap {
            transform: rotateX(180deg);
        }

        .envelope-heart {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 50px;
            z-index: 1;
            animation: heartPulse 1s ease-in-out infinite;
        }

        @keyframes heartPulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.15); }
        }

        .envelope-text {
            position: absolute;
            bottom: -50px;
            left: 50%;
            transform: translateX(-50%);
            font-family: var(--font-minecraft);
            font-size: 0.7rem;
            color: var(--color-cream);
            white-space: nowrap;
            animation: textBlink 1.5s step-end infinite;
        }

        @keyframes textBlink {
            50% { opacity: 0.5; }
        }

        .wax-seal {
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 50px;
            background: radial-gradient(circle at 30% 30%, #c41e3a, #8b0000);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            z-index: 3;
        }

        /* ============================================
           MAIN CARD
        ============================================ */
        .card-wrapper {
            position: relative;
            z-index: 10;
            opacity: 0;
            transform: scale(0.8) translateY(30px);
            transition: all 0.8s var(--transition-bounce);
        }

        .card-wrapper.visible {
            opacity: 1;
            transform: scale(1) translateY(0);
        }

        .card {
            background: linear-gradient(145deg, #fffaf0, #fff5ee);
            border-radius: 20px;
            padding: 45px 55px;
            text-align: center;
            box-shadow: 0 30px 60px rgba(0,0,0,0.3);
            position: relative;
            max-width: 500px;
            width: 90%;
            border: 4px solid var(--color-primary);
            image-rendering: pixelated;
        }

        .ribbon {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #c41e3a, #8b0000);
            color: white;
            padding: 8px 25px;
            font-family: var(--font-minecraft);
            font-size: 0.5rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            box-shadow: 0 4px 15px rgba(139, 0, 0, 0.4);
        }

        .ribbon::before, .ribbon::after {
            content: '';
            position: absolute;
            bottom: -8px;
            border: 8px solid transparent;
            border-top-color: #6b0000;
        }

        .ribbon::before { left: 0; border-left-color: #6b0000; }
        .ribbon::after { right: 0; border-right-color: #6b0000; }

        /* ============================================
           TYPOGRAPHY
        ============================================ */
        .heart-icon {
            font-size: 65px;
            display: inline-block;
            animation: heartBeat 1.2s ease-in-out infinite;
            filter: drop-shadow(0 5px 20px rgba(255, 100, 150, 0.6));
            margin-bottom: 15px;
        }

        @keyframes heartBeat {
            0%, 100% { transform: scale(1); }
            15% { transform: scale(1.2); }
            30% { transform: scale(1); }
            45% { transform: scale(1.15); }
            60% { transform: scale(1); }
        }

        .title {
            font-family: var(--font-minecraft);
            font-size: 1rem;
            color: var(--color-text);
            margin: 15px 0;
            line-height: 1.8;
            min-height: 60px;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.1);
        }

        .title .cursor {
            display: inline-block;
            width: 12px;
            height: 20px;
            background: var(--color-secondary);
            margin-left: 3px;
            animation: cursorBlink 0.6s step-end infinite;
            vertical-align: middle;
        }

        @keyframes cursorBlink {
            50% { opacity: 0; }
        }

        .subtitle {
            font-family: var(--font-script);
            font-size: 1.3rem;
            color: var(--color-text-light);
            margin: 15px 0 25px;
            font-style: italic;
            opacity: 0;
            animation: fadeIn 1s ease 2.5s forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        /* ============================================
           LOVE METER (Minecraft style)
        ============================================ */
        .love-meter {
            margin: 20px 0;
            opacity: 0;
            animation: fadeIn 1s ease 3s forwards;
        }

        .love-meter-label {
            font-family: var(--font-minecraft);
            font-size: 0.5rem;
            color: var(--color-text-light);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
        }

        .love-meter-bar {
            height: 20px;
            background: #333;
            border: 3px solid #222;
            border-radius: 3px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
        }

        .love-meter-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(180deg, #ff6b6b 0%, #cc4444 50%, #ff6b6b 100%);
            transition: width 0.5s ease;
            position: relative;
            box-shadow: inset 0 -2px 0 rgba(0,0,0,0.3);
        }

        .love-meter-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: rgba(255,255,255,0.3);
        }

        /* ============================================
           BUTTONS
        ============================================ */
        .buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            min-height: 70px;
            align-items: center;
            margin-top: 20px;
            opacity: 0;
            animation: fadeIn 1s ease 3.2s forwards;
        }

        .btn {
            padding: 16px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            font-family: var(--font-body);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            position: relative;
            letter-spacing: 0.5px;
            overflow: hidden;
        }

        /* Yes Button - Elegant gradient */
        .btn-yes {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a5a 50%, #c44569 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(196, 69, 105, 0.4);
        }

        .btn-yes::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s ease;
        }

        .btn-yes:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 15px 35px rgba(196, 69, 105, 0.5);
        }

        .btn-yes:hover::before {
            left: 100%;
        }

        .btn-yes:active {
            transform: translateY(-2px) scale(1.02);
        }

        /* No Button - Soft and subtle */
        .btn-no {
            background: linear-gradient(135deg, #f8f8f8 0%, #e8e8e8 100%);
            color: #888;
            border: 2px solid #ddd;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            position: fixed;
            z-index: 1000;
            user-select: none;
            transition:
                left 0.25s var(--transition-smooth),
                top 0.25s var(--transition-smooth),
                opacity 0.5s ease,
                transform 0.3s var(--transition-smooth),
                box-shadow 0.3s ease;
        }

        .btn-no:hover {
            transform: translate(-50%, -50%) scale(1.05);
            border-color: #ccc;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .btn-no.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transform: translate(-50%, -50%) scale(0);
        }

        /* ============================================
           SUCCESS SCREEN
        ============================================ */
        .success-screen {
            display: none;
            flex-direction: column;
            align-items: center;
        }

        .success-screen.active {
            display: flex;
            animation: successPop 0.8s var(--transition-bounce);
        }

        @keyframes successPop {
            0% { transform: scale(0) rotate(-20deg); opacity: 0; }
            60% { transform: scale(1.2) rotate(5deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        .success-heart {
            font-size: 100px;
            animation: megaHeart 0.4s ease infinite alternate;
        }

        @keyframes megaHeart {
            0% { transform: scale(1) rotate(-15deg); filter: hue-rotate(0deg); }
            100% { transform: scale(1.2) rotate(15deg); filter: hue-rotate(20deg); }
        }

        .success-title {
            font-family: var(--font-minecraft);
            font-size: 1rem;
            color: var(--color-secondary);
            margin-top: 20px;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.1);
            animation: rainbowText 2s linear infinite;
        }

        @keyframes rainbowText {
            0% { color: #ff6b6b; }
            25% { color: #ffd93d; }
            50% { color: #6bcb77; }
            75% { color: #4d96ff; }
            100% { color: #ff6b6b; }
        }

        .success-message {
            font-family: var(--font-pixel);
            color: var(--color-text-light);
            margin-top: 15px;
            font-size: 1.2rem;
        }

        .success-hearts {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            animation: heartsWave 1s ease-in-out infinite;
        }

        .success-hearts span {
            font-size: 30px;
            animation: heartJump 0.5s ease infinite alternate;
        }

        .success-hearts span:nth-child(2) { animation-delay: 0.1s; }
        .success-hearts span:nth-child(3) { animation-delay: 0.2s; }
        .success-hearts span:nth-child(4) { animation-delay: 0.3s; }
        .success-hearts span:nth-child(5) { animation-delay: 0.4s; }

        @keyframes heartJump {
            0% { transform: translateY(0); }
            100% { transform: translateY(-15px); }
        }

        /* ============================================
           CONFETTI & PARTICLES
        ============================================ */
        .confetti {
            position: fixed;
            top: -30px;
            z-index: 150;
            animation: confettiFall linear forwards;
            pointer-events: none;
            font-family: var(--font-minecraft);
        }

        @keyframes confettiFall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(110vh) rotate(1080deg); opacity: 0; }
        }

        .firework {
            position: fixed;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 150;
        }

        .firework-particle {
            position: fixed;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 150;
            animation: fireworkExplode 1.5s ease-out forwards;
        }

        @keyframes fireworkExplode {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { opacity: 0; }
        }

        /* ============================================
           RIPPLE
        ============================================ */
        .ripple {
            position: fixed;
            border: 4px solid var(--color-primary);
            border-radius: 50%;
            pointer-events: none;
            animation: rippleEffect 0.8s ease-out forwards;
            z-index: 9998;
        }

        @keyframes rippleEffect {
            0% { width: 0; height: 0; opacity: 1; }
            100% { width: 200px; height: 200px; opacity: 0; }
        }

        /* ============================================
           CURSOR HEART TRAIL
        ============================================ */
        .cursor-heart {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            font-size: 20px;
            animation: cursorHeartFade 1s ease-out forwards;
        }

        @keyframes cursorHeartFade {
            0% {
                opacity: 1;
                transform: scale(1) translateY(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: scale(0.5) translateY(-40px) rotate(20deg);
            }
        }

        /* ============================================
           RESPONSIVE
        ============================================ */
        @media (max-width: 600px) {
            .card { padding: 35px 25px; margin: 15px; }
            .title { font-size: 0.75rem; }
            .heart-icon { font-size: 50px; }
            .envelope { width: 220px; height: 140px; }
            .btn { padding: 12px 25px; font-size: 0.6rem; }
            .setup-box { padding: 30px 25px; }
            .setup-title { font-size: 0.9rem; }
            .setup-btn { font-size: 0.55rem; padding: 12px 15px; }
        }
    </style>
</head>
<body>
    <!-- Setup Screen -->
    <div class="setup-screen" id="setupScreen">
        <div class="setup-box">
            <div class="setup-heart">üíù</div>
            <h1 class="setup-title">Valentine Setup</h1>
            <p class="setup-subtitle">Customize your proposal!</p>

            <div class="setup-input-group">
                <label class="setup-label">Background Image URL (Optional)</label>
                <input
                    type="url"
                    class="setup-input"
                    id="bgInput"
                    placeholder="https://example.com/your-image.jpg"
                >
                <p class="setup-hint">Leave empty for default starry night background</p>
            </div>

            <div class="setup-buttons">
                <button class="setup-btn setup-btn-secondary" onclick="skipSetup()">Skip</button>
                <button class="setup-btn setup-btn-primary" onclick="startWithBg()">Start!</button>
            </div>
        </div>
    </div>

    <!-- Starry Background -->
    <div class="stars" id="stars"></div>

    <!-- Custom Background -->
    <div class="background" id="customBg"></div>

    <!-- Floating Elements -->
    <div class="floating-container" id="floatingContainer"></div>

    <!-- Envelope Intro -->
    <div class="envelope-container" id="envelopeContainer">
        <div class="envelope" onclick="openEnvelope()">
            <div class="envelope-body"></div>
            <div class="envelope-flap"></div>
            <div class="envelope-heart">üíå</div>
            <div class="wax-seal">‚ù§</div>
            <div class="envelope-text">>> CLICK TO OPEN <<</div>
        </div>
    </div>

    <!-- Main Card -->
    <div class="card-wrapper" id="cardWrapper">
        <div class="card">
            <div class="ribbon">With Love</div>

            <div class="main-content" id="mainContent">
                <div class="heart-icon">üíù</div>
                <h1 class="title" id="title"><span class="cursor"></span></h1>
                <p class="subtitle">"You are my Player 2 forever"</p>

                <div class="love-meter">
                    <div class="love-meter-label">
                        <span>LOVE LEVEL</span>
                        <span id="lovePercent">MAX!</span>
                    </div>
                    <div class="love-meter-bar">
                        <div class="love-meter-fill" id="loveFill"></div>
                    </div>
                </div>

                <div class="buttons">
                    <button class="btn btn-yes" id="yesBtn">YES!</button>
                </div>
            </div>

            <div class="success-screen" id="successScreen">
                <div class="success-heart">üíñ</div>
                <h2 class="success-title">I LOVE YOU!</h2>
                <p class="success-message">You made me the happiest!</p>
                <div class="success-hearts">
                    <span>‚ù§Ô∏è</span>
                    <span>üíï</span>
                    <span>üíñ</span>
                    <span>üíï</span>
                    <span>‚ù§Ô∏è</span>
                </div>
            </div>
        </div>
    </div>

    <!-- No Button -->
    <button class="btn btn-no" id="noBtn">NO</button>

    <script>
        /**
         * ============================================
         * VALENTINE PROPOSAL - MINECRAFT EDITION
         * ============================================
         */

        // DOM Elements
        const setupScreen = document.getElementById('setupScreen');
        const envelopeContainer = document.getElementById('envelopeContainer');
        const cardWrapper = document.getElementById('cardWrapper');
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const mainContent = document.getElementById('mainContent');
        const successScreen = document.getElementById('successScreen');
        const titleEl = document.getElementById('title');
        const loveFill = document.getElementById('loveFill');
        const floatingContainer = document.getElementById('floatingContainer');
        const starsContainer = document.getElementById('stars');
        const customBg = document.getElementById('customBg');
        const bgInput = document.getElementById('bgInput');

        // Default background
        const DEFAULT_BG = 'https://images.unsplash.com/photo-1518199266791-5375a83190b7?w=1920&q=80';

        // Config
        const CONFIG = {
            escapeRadius: 100,
            escapeDistance: 160,
            viewportPadding: 70,
            starCount: 120,
            heartCount: 15,
            pixelHeartCount: 10
        };

        const escapeMessages = [
            "NO", "NOPE!", "TRY AGAIN", "HEHE",
            "CATCH ME!", "TOO SLOW!", "SAY YES!",
            "PLEASE?", "NEVER!", "NICE TRY!"
        ];

        let escapeCount = 0;
        let isEnvelopeOpen = false;
        let hasCustomBg = false;

        /**
         * Setup functions
         */
        function skipSetup() {
            setBackground(DEFAULT_BG);
            hideSetup();
        }

        function startWithBg() {
            const url = bgInput.value.trim();
            if (url) {
                testImage(url).then(valid => {
                    setBackground(valid ? url : DEFAULT_BG);
                    hideSetup();
                });
            } else {
                setBackground(DEFAULT_BG);
                hideSetup();
            }
        }

        function testImage(url) {
            return new Promise(resolve => {
                const img = new Image();
                img.onload = () => resolve(true);
                img.onerror = () => resolve(false);
                img.src = url;
                // Timeout after 5 seconds
                setTimeout(() => resolve(false), 5000);
            });
        }

        function setBackground(url) {
            customBg.style.backgroundImage = `url('${url}')`;
            hasCustomBg = url !== DEFAULT_BG;
        }

        function hideSetup() {
            setupScreen.classList.add('hidden');
            envelopeContainer.classList.add('visible');
            createStars();
            createFloatingElements();
        }

        /**
         * Create stars
         */
        function createStars() {
            for (let i = 0; i < CONFIG.starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                star.style.width = `${2 + Math.random() * 3}px`;
                star.style.height = star.style.width;
                star.style.animationDelay = `${Math.random() * 3}s`;
                star.style.animationDuration = `${1 + Math.random() * 2}s`;
                starsContainer.appendChild(star);
            }

            for (let i = 0; i < 4; i++) {
                const shootingStar = document.createElement('div');
                shootingStar.className = 'shooting-star';
                shootingStar.style.top = `${Math.random() * 40}%`;
                shootingStar.style.right = '-100px';
                shootingStar.style.animationDelay = `${i * 5 + Math.random() * 3}s`;
                starsContainer.appendChild(shootingStar);
            }
        }

        /**
         * Create floating elements
         */
        function createFloatingElements() {
            const hearts = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíì'];

            for (let i = 0; i < CONFIG.heartCount; i++) {
                const heart = document.createElement('div');
                heart.className = 'floating-heart';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = `${Math.random() * 100}%`;
                heart.style.fontSize = `${20 + Math.random() * 30}px`;
                heart.style.animationDelay = `${Math.random() * 10}s`;
                heart.style.animationDuration = `${8 + Math.random() * 6}s`;
                floatingContainer.appendChild(heart);
            }

            for (let i = 0; i < CONFIG.pixelHeartCount; i++) {
                const pixel = document.createElement('div');
                pixel.className = 'pixel-heart';
                pixel.style.left = `${Math.random() * 100}%`;
                pixel.style.animationDelay = `${Math.random() * 8}s`;
                pixel.style.animationDuration = `${6 + Math.random() * 4}s`;
                pixel.style.background = `hsl(${340 + Math.random() * 40}, 80%, 60%)`;
                floatingContainer.appendChild(pixel);
            }
        }

        /**
         * Typewriter effect
         */
        function typeWriter(text, element, speed = 100) {
            let i = 0;
            const cursor = element.querySelector('.cursor');

            function type() {
                if (i < text.length) {
                    element.insertBefore(document.createTextNode(text.charAt(i)), cursor);
                    i++;
                    setTimeout(type, speed);
                }
            }
            type();
        }

        /**
         * Open envelope
         */
        function openEnvelope() {
            if (isEnvelopeOpen) return;
            isEnvelopeOpen = true;

            createRipple(window.innerWidth / 2, window.innerHeight / 2);

            setTimeout(() => {
                envelopeContainer.classList.remove('visible');
                envelopeContainer.classList.add('hidden');
                cardWrapper.classList.add('visible');
                noBtn.style.opacity = '1';
                positionNoButton();

                setTimeout(() => {
                    typeWriter("Will You Be My Valentine?", titleEl);
                }, 500);

                setTimeout(() => {
                    loveFill.style.width = '100%';
                }, 3500);
            }, 600);
        }

        /**
         * Position No button
         */
        function positionNoButton() {
            const yesRect = yesBtn.getBoundingClientRect();
            noBtn.style.left = `${yesRect.right + 60}px`;
            noBtn.style.top = `${yesRect.top + yesRect.height / 2}px`;
            noBtn.style.transform = 'translate(-50%, -50%)';
        }

        /**
         * Distance calculation
         */
        function getDistance(x1, y1, x2, y2) {
            return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
        }

        /**
         * Handle pointer move
         */
        function handlePointerMove(clientX, clientY) {
            if (!isEnvelopeOpen) return;

            const rect = noBtn.getBoundingClientRect();
            const btnX = rect.left + rect.width / 2;
            const btnY = rect.top + rect.height / 2;
            const distance = getDistance(clientX, clientY, btnX, btnY);

            if (distance < CONFIG.escapeRadius) {
                escapeButton(clientX, clientY, btnX, btnY);
            }
        }

        /**
         * Escape button
         */
        function escapeButton(pointerX, pointerY, btnX, btnY) {
            escapeCount = (escapeCount + 1) % escapeMessages.length;
            noBtn.textContent = escapeMessages[escapeCount];

            const angle = Math.atan2(btnY - pointerY, btnX - pointerX);
            const randomOffset = (Math.random() - 0.5) * 0.6;
            const finalAngle = angle + randomOffset;

            let newX = btnX + Math.cos(finalAngle) * CONFIG.escapeDistance;
            let newY = btnY + Math.sin(finalAngle) * CONFIG.escapeDistance;

            const maxX = window.innerWidth - CONFIG.viewportPadding;
            const maxY = window.innerHeight - CONFIG.viewportPadding;

            newX = Math.max(CONFIG.viewportPadding, Math.min(maxX, newX));
            newY = Math.max(CONFIG.viewportPadding, Math.min(maxY, newY));

            // Corner escape
            const currentRect = noBtn.getBoundingClientRect();
            const currentX = currentRect.left + currentRect.width / 2;
            const currentY = currentRect.top + currentRect.height / 2;

            if (Math.abs(newX - currentX) < 25 && Math.abs(newY - currentY) < 25) {
                newX = pointerX < window.innerWidth / 2
                    ? window.innerWidth - CONFIG.viewportPadding - 60
                    : CONFIG.viewportPadding + 60;
                newY = pointerY < window.innerHeight / 2
                    ? window.innerHeight - CONFIG.viewportPadding - 60
                    : CONFIG.viewportPadding + 60;
            }

            noBtn.style.left = `${newX}px`;
            noBtn.style.top = `${newY}px`;
            noBtn.style.transform = 'translate(-50%, -50%)';
        }

        /**
         * Create fireworks
         */
        function createFireworks() {
            const colors = ['#ff6b6b', '#ffd93d', '#6bcb77', '#4d96ff', '#ff6b9d', '#c44569', '#ffd700'];

            for (let f = 0; f < 8; f++) {
                setTimeout(() => {
                    const x = Math.random() * window.innerWidth * 0.8 + window.innerWidth * 0.1;
                    const y = Math.random() * window.innerHeight * 0.5 + 50;
                    const color = colors[Math.floor(Math.random() * colors.length)];

                    for (let i = 0; i < 20; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'firework-particle';
                        particle.style.left = `${x}px`;
                        particle.style.top = `${y}px`;
                        particle.style.background = color;
                        particle.style.boxShadow = `0 0 6px ${color}`;

                        const angle = (i / 20) * Math.PI * 2;
                        const distance = 80 + Math.random() * 60;
                        const endX = Math.cos(angle) * distance;
                        const endY = Math.sin(angle) * distance;

                        particle.style.transform = `translate(${endX}px, ${endY}px)`;
                        document.body.appendChild(particle);

                        setTimeout(() => particle.remove(), 1500);
                    }
                }, f * 400);
            }
        }

        /**
         * Create confetti
         */
        function createConfetti() {
            const items = ['‚ù§Ô∏è', 'üíï', 'üíñ', '‚≠ê', '‚ú®', 'üéâ', 'üíó', '‚ô•'];
            const colors = ['#ff6b6b', '#ffd93d', '#6bcb77', '#4d96ff', '#ff6b9d'];

            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.textContent = items[Math.floor(Math.random() * items.length)];
                    confetti.style.left = `${Math.random() * 100}%`;
                    confetti.style.fontSize = `${20 + Math.random() * 25}px`;
                    confetti.style.animationDuration = `${2.5 + Math.random() * 2}s`;
                    document.body.appendChild(confetti);

                    setTimeout(() => confetti.remove(), 5000);
                }, i * 40);
            }
        }

        /**
         * Create cursor heart trail
         */
        let lastTrailTime = 0;
        function createCursorTrail(x, y) {
            const now = Date.now();
            if (now - lastTrailTime < 80) return;
            lastTrailTime = now;

            const hearts = ['üíï', 'üíñ', '‚ù§Ô∏è', '‚ú®', 'üíó'];
            const heart = document.createElement('div');
            heart.className = 'cursor-heart';
            heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
            heart.style.left = `${x}px`;
            heart.style.top = `${y}px`;
            document.body.appendChild(heart);

            setTimeout(() => heart.remove(), 1000);
        }

        /**
         * Create ripple
         */
        function createRipple(x, y) {
            const ripple = document.createElement('div');
            ripple.className = 'ripple';
            ripple.style.left = `${x}px`;
            ripple.style.top = `${y}px`;
            ripple.style.transform = 'translate(-50%, -50%)';
            document.body.appendChild(ripple);
            setTimeout(() => ripple.remove(), 800);
        }

        /**
         * Handle Yes click
         */
        function handleYesClick() {
            // Hide No button
            noBtn.classList.add('hidden');

            // Show success
            mainContent.style.display = 'none';
            successScreen.classList.add('active');

            // Massive celebration!
            createConfetti();
            createFireworks();

            // Screen flash effect
            document.body.style.animation = 'flashBg 0.3s ease';

            // Continue fireworks
            setTimeout(createFireworks, 2000);
            setTimeout(createFireworks, 4000);
        }

        /**
         * Initialize
         */
        function init() {
            noBtn.style.opacity = '0';

            yesBtn.addEventListener('click', handleYesClick);

            document.addEventListener('mousemove', (e) => {
                handlePointerMove(e.clientX, e.clientY);
                createCursorTrail(e.clientX, e.clientY);
            });

            document.addEventListener('touchmove', (e) => {
                const touch = e.touches[0];
                handlePointerMove(touch.clientX, touch.clientY);
            }, { passive: true });

            document.addEventListener('click', (e) => {
                if (!setupScreen.classList.contains('hidden')) return;
                createRipple(e.clientX, e.clientY);
            });

            noBtn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                const rect = noBtn.getBoundingClientRect();
                escapeButton(e.clientX, e.clientY, rect.left + rect.width / 2, rect.top + rect.height / 2);
            });

            window.addEventListener('resize', () => {
                if (isEnvelopeOpen && !noBtn.classList.contains('hidden')) {
                    const rect = noBtn.getBoundingClientRect();
                    if (rect.left < 0 || rect.right > window.innerWidth) {
                        positionNoButton();
                    }
                }
            });

            // Enter key on input
            bgInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') startWithBg();
            });
        }

        init();
    </script>
</body>
</html>
